---
layout: post
title: Teams - Locations
date: 2020-06-26 13:00
author: beierca
comments: true
categories: [Administration, Microsoft Teams, network, Powershell, setup, sites, trusted public ips]
---
<p><!-- wp:paragraph --></p><p style="text-align:justify;">Hi there</p><p style="text-align:justify;">today I'm talking about Microsoft Teams Locations and demonstrating how to use powershell script to populate subnets and trusted public ips.</p><p style="text-align:justify;">Microsoft Teams Locations are dividing into:</p><ul style="text-align:justify;"><li><strong>Reporting Labels</strong>: Reporting labels are used to give an IP subnet a name that links it to a physical location such as offices, buildings, or organizational sites within your organization. They are used by Call Analytics to make it easier to see a name of a place instead of just an IP subnet in reports. <span style="color:#ff0000;">Use the same information from Emergency Addresses and Network Topology to create its CSV.</span></li><li><strong>Emergency Addresses</strong>: Emergency address is a civic address which is a physical street address of a place of business for your organization. An emergency location is a civic address with an optional place</li><li><strong>Network topology</strong>: You can use network topology to define the network regions, sites, and subnets that are used to determine the emergency call routing and calling policies that are to be used for a given location</li><li><strong>Networks and locations</strong>: Each subnet must be associated with a specific network site. A client's location is determined based on the network subnet and the associated network site. You can associate multiple subnets with the same network site but you can't associate multiple sites with the same subnet</li></ul><p style="text-align:justify;">The scripts will cover Network Topology subnets within network sites and trusted IPs</p><p style="text-align:justify;">To complete this task for a project I created all Emergency Addresses at <a href="https://admin.teams.microsoft.com/locations" target="_blank" rel="noopener">https://admin.teams.microsoft.com/locations</a> beforehand using the design documentation we validated with client. Than we added / created all Network Sites at <a href="https://admin.teams.microsoft.com/tenantnetworksite" target="_blank" rel="noopener">https://admin.teams.microsoft.com/tenantnetworksite</a> as well.</p><p style="text-align:justify;">You might find surprises when you add the Emergency Addresses due to Postal Code issue or address issue when <a href="https://www.bing.com" target="_blank" rel="noopener"><strong>Bing</strong></a> tries to resolve it. In order to solve this - add / edit address manually.</p><p style="text-align:justify;">After we used powershell with CSV files to add all subnets and trusted ips to each identity.</p><p><em><strong>Network subnet PowerShell</strong><br />- <a href="https://thiagobeierblog.blob.core.windows.net/posts/o365/teams/F/subnet2.csv" target="_blank" rel="noopener">download subnet2.csv file exampe</a></em></p><table><tbody><tr><td width="623"><pre>Import-CSV subnet2.csv | foreach {<br />New-CsTenantNetworkSubnet â€“SubnetID $_.Identity -MaskBits $_.Mask -NetworkSiteID $_.SiteID<br />}</pre><p>&nbsp;</p></td></tr></tbody></table><p><img style="max-width:100%;" src="https://thiagobeierblog.blob.core.windows.net/posts/o365/teams/F/1.png" /></p><p><strong><em>Trusted public ips PowerShell script</em></strong></p><p>- <a href="https://thiagobeierblog.blob.core.windows.net/posts/o365/teams/F/trustedips.csv" target="_blank" rel="noopener">download trustedips.csv file</a></p><table><tbody><tr><td width="623"><pre>Import-CSV .\trustedips.csv | foreach {<br />New-CsTenantTrustedIPAddress -IPAddress $_.Identity -MaskBits $_.Mask<br />}</pre><p>&nbsp;</p></td></tr></tbody></table><p><img style="max-width:100%;" src="https://thiagobeierblog.blob.core.windows.net/posts/o365/teams/F/2.png" /></p><p><strong>References</strong></p><p>https://docs.microsoft.com/en-US/microsoftteams/learn-more-about-site-upload?WT.mc_id=TeamsAdminCenterCSH</p><p>https://docs.microsoft.com/en-us/microsoftteams/manage-your-network-topology</p><p><strong><span style="color:#ff0000;">Check my <a style="color:#ff0000;" href="https://github.com/thiagobeier/scripts/blob/master/README.md"><span style="color:#0000ff;">Github</span></a> repository</span></strong></p><p><!-- /wp:paragraph -->

<!-- wp:paragraph --></p><p>Thanks,</p><p><!-- /wp:paragraph -->

<!-- wp:paragraph --></p><p>Thiago Beier<br /><a href="https://twitter.com/thiagobeier"><img title="Twitter" src="https://socialmediawidgets.files.wordpress.com/2014/03/twitter1.png" alt="Twitter" width="35" height="35" /></a><a href="https://www.linkedin.com/in/tbeier/"><img title="LinkedIn" src="https://socialmediawidgets.files.wordpress.com/2014/03/linkedin1.png" alt="LinkedIn" width="35" height="35" /></a><a href="https://www.facebook.com/TheBeier/"><img title="Facebook" src="https://socialmediawidgets.files.wordpress.com/2014/03/facebook1.png" alt="Facebook" width="35" height="35" /></a><a href="https://thiagobeier.wordpress.com/feed/"><img title="RSS" src="https://socialmediawidgets.files.wordpress.com/2014/03/rss1.png" alt="RSS" width="35" height="35" /></a></p><p><!-- /wp:paragraph --></p>
